<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
   <title>Preskool - Dashboard</title>
   <link rel="shortcut icon" href="assets/img/favicon.png">

   <link rel="stylesheet" href="assets/plugins/simple-calendar/simple-calendar.css">
   <link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,500;0,600;0,700;1,400&amp;display=swap">
   <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
   <link rel="stylesheet" href="assets/plugins/fontawesome/css/fontawesome.min.css">
   <link rel="stylesheet" href="assets/plugins/fontawesome/css/all.min.css">
   <link rel="stylesheet" href="assets/css/style.css">
   <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.7/axios.js"></script>
   <link rel="icon" href="assets/img/logo-small.png" type="image/x-icon">
   <link rel="shortcut icon" href="assets/img/logo-small.png" type="image/x-icon">
   <style>
      .button {
         display: flex;
         height: 50px;
         padding: 0;
         border: none;
         outline: none;
         border-radius: 5px;
         overflow: hidden;
         font-family: "Quicksand", sans-serif;
         font-size: 16px;
         font-weight: 500;
         cursor: pointer;
      }

      .approve {
         background-color: #0b6856;
      }

      .reject {
         background-color: red;
      }

      .approve:hover {
         background: #008168;
      }

      .approve:active {
         background: #006e58;
      }

      .reset {
         background-color: rgb(3, 100, 61);
      }

      .reset:hover {
         background: #03e0b4;
      }

      .reset:active {
         background: #04f8c7;
      }


      .reject:hover {
         background: #f12222;
      }

      .reject:active {
         background: #f83e44;
      }

      .button__text,
      .button__icon {
         display: inline-flex;
         align-items: center;
         padding: 0 24px;
         color: #fff;
         height: 100%;
      }

      .button__icon {
         font-size: 1.5em;
         background: rgba(0, 0, 0, 0.08);
      }
   </style>
</head>

<body>
   <div class="main-wrapper">
      <div class="header">
         <div class="header-left">
            <a href="index.html" class="logo">
               <img src="assets/img/logo.svg" alt="Logo">
            </a>
            <a href="index.html" class="logo logo-small">
               <img src="assets/img/logo-small.svg" alt="Logo" width="30" height="45">
            </a>
         </div>
         <a href="javascript:void(0);" id="toggle_btn">
            <i class="fas fa-align-left"></i>
         </a>

         <a class="mobile_btn" id="mobile_btn">
            <i class="fas fa-bars"></i>
         </a>
         <ul class="nav user-menu">

            <li class="nav-item dropdown has-arrow">
               <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                  <span class="user-img"><img class="rounded-circle" src="assets/img/profiles/avatar-01.png" width="31"
                        alt="Ryan Taylor"></span>
               </a>
               <div class="dropdown-menu">
                  <div class="user-header">
                     <div class="avatar avatar-sm">
                        <img src="assets/img/profiles/avatar-01.png" alt="User Image" class="avatar-img rounded-circle">
                     </div>
                     <div class="user-text">
                        <h6>Admin</h6>

                     </div>
                  </div>
                  <a class="dropdown-item" href="profile.html">My Profile</a>
                  <a class="dropdown-item" href="inbox.html">Inbox</a>
                  <a class="dropdown-item" href="login.html">Logout</a>
               </div>
            </li>
         </ul>
      </div>
      <div class="sidebar" id="sidebar">
         <div class="sidebar-inner slimscroll">
            <div id="sidebar-menu" class="sidebar-menu">
               <ul>


                  <li class="active">
                     <a href="admin.html"><i class="fas fa-user-graduate"></i> <span> Dashboard</span><span
                           class="menu-arrow"></span></a>

                  </li>
                  <li>
                     <a href="students_oehm_sem5_online.html"><i class="fas fa-code"></i> <span>Students</span> <span
                           class="menu-arrow"></span></a>

                  </li>
                  <li class="">
                     <a href="#"><i class="fas fa-chalkboard-teacher"></i> <span> Teachers</span>
                        <span class="menu-arrow"></span></a>
                     <ul>

                     </ul>
                  </li>
                  <li class="">
                     <a href="department.html"><i class="fas fa-building"></i> <span> Departments</span> <span
                           class="menu-arrow"></span></a>

                  </li>
                  <li class="">
                     <a href="subject_oehm_sem5.html"><i class="fas fa-code"></i> <span>Subjects</span> <span
                           class="menu-arrow"></span></a>

                  </li>

               </ul>
            </div>
         </div>
      </div>
      <div class="page-wrapper">
         <div class="content container-fluid">
            <div class="page-header">
               <div class="row">
                  <div class="col-sm-10">
                     <h3 class="page-title">Welcome Admin!</h3>
                     <ul class="breadcrumb">
                        <li class="breadcrumb-item active">Dashboard</li>
                     </ul>
                  </div>
                  <div class="col-sm-2">
                     <button type="button " class="button reset" onclick="restSem()">
                        <span class="button__text">Reset Semester</span>
                        <span class="button__icon">
                           <ion-icon name="sync-outline"></ion-icon>
                        </span>
                     </button>
                  </div>
               </div>
            </div>
            <div class="row">
               <div class="col-xl-3 col-sm-6 col-12 d-flex">
                  <div class="card bg-five w-100">
                     <div class="card-body">
                        <div class="db-widgets d-flex justify-content-between align-items-center">
                           <div class="db-icon">
                              <i class="fas fa-chalkboard"></i>
                           </div>
                           <div class="db-info">
                              <h3>04/06</h3>
                              <h6>Total Classes</h6>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-xl-3 col-sm-6 col-12 d-flex">
                  <div class="card bg-six w-100">
                     <div class="card-body">
                        <div class="db-widgets d-flex justify-content-between align-items-center">
                           <div class="db-icon">
                              <i class="fas fa-user-graduate"></i>
                           </div>
                           <div class="db-info">
                              <h3>40/60</h3>
                              <h6>Total Students</h6>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-xl-3 col-sm-6 col-12 d-flex">
                  <div class="card bg-seven w-100">
                     <div class="card-body">
                        <div class="db-widgets d-flex justify-content-between align-items-center">
                           <div class="db-icon">
                              <i class="fas fa-book-open"></i>
                           </div>
                           <div class="db-info">
                              <h3>30/50</h3>
                              <h6>Total Lessons</h6>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-xl-3 col-sm-6 col-12 d-flex">
                  <div class="card bg-eight w-100">
                     <div class="card-body">
                        <div class="db-widgets d-flex justify-content-between align-items-center">
                           <div class="db-icon">
                              <i class="fas fa-clock"></i>
                           </div>
                           <div class="db-info">
                              <h3>15/20</h3>
                              <h6>Total Hours</h6>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="row">
               <div class="col-xl-3 col-sm-6 col-12 d-flex">
                  <div class="card bg-five w-100">
                     <div class="card-body">
                        <div class="db-widgets d-flex justify-content-between align-items-center">
                           <div class="db-icon">
                              <i class="fas fa-chalkboard"></i>
                           </div>
                           <div class="db-info">
                              <h3>04/06</h3>
                              <h6>Total Classes</h6>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-xl-3 col-sm-6 col-12 d-flex">
                  <div class="card bg-six w-100">
                     <div class="card-body">
                        <div class="db-widgets d-flex justify-content-between align-items-center">
                           <div class="db-icon">
                              <i class="fas fa-user-graduate"></i>
                           </div>
                           <div class="db-info">
                              <h3>40/60</h3>
                              <h6>Total Students</h6>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-xl-3 col-sm-6 col-12 d-flex">
                  <div class="card bg-seven w-100">
                     <div class="card-body">
                        <div class="db-widgets d-flex justify-content-between align-items-center">
                           <div class="db-icon">
                              <i class="fas fa-book-open"></i>
                           </div>
                           <div class="db-info">
                              <h3>30/50</h3>
                              <h6>Total Lessons</h6>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-xl-3 col-sm-6 col-12 d-flex">
                  <div class="card bg-eight w-100">
                     <div class="card-body">
                        <div class="db-widgets d-flex justify-content-between align-items-center">
                           <div class="db-icon">
                              <i class="fas fa-clock"></i>
                           </div>
                           <div class="db-info">
                              <h3>15/20</h3>
                              <h6>Total Hours</h6>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="row">
               <div class="col col-4">
                  <h3>Approvals/Rejeted Students</h3>
               </div>
               </div>
               <div class="row" style="margin-bottom:10px ;">
                  <div class="col col-2 ">
                     <button  class="button reject" onclick="getdata('rejected')">
                        <span class="button__text" >Rejected</span>
                        </span>
                     </button>
                     </div>
                     <div class="col col-1">
                     <button class="button approve" onclick="getdata('approval')">
                        <span class="button__text" >Approvals</span>
                        </span>
                     </button>

            </div>
            
            </div>
            <div class="row">
               <div class="col-sm-12">
                  <div class="card card-table">
                     <div class="card-body">
                        <div class="table-responsive">
                           <table class="table table-hover table-center mb-0 datatable" id="data-table">
                              <thead>
                                 <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Email</th>

                                    <th>Semester</th>
                                    <th>Department</th>
                                    <th>Domain</th>
                                    <th>Course Type</th>
                                    <th>Course Name</th>
                                    <th>Hours</th>
                                    <th>Total Hours</th>
                                    <th>Approve</th>
                                 </tr>
                              </thead>
                              <tbody id="tbody">

                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>




      </div>
      <div class="row">

      </div>
      <!-- <footer>
               <p>Copyright © 2020 Dreamguys.</p>
            </footer> -->
   </div>
   </div>

   <script>
      async function getdata(choice) {
         var tbody = '';
         var semester="--Select Semester--"
         var apprej = choice;
         var type = "--Select Course Type--";
         var branch = "--Select Branch--";
         var data;
         console.log(apprej)
         try {
            data = await axios({
               url: "http://localhost:8000/getStudentDataOnlineall",
               method: "post",
               data: { semester: semester, courseType: type, branch: branch ,apprej:apprej}
            });
            console.log(data.data.result);
            //   console.log(data.data.result[0].domain);
            console.log(data.data.certificates);
            var list = data.data.result;
            var course = data.data.course;
            var certificates = data.data.certificates;
            var hours = 0;
            var t; // to check for approval and rejected
            
            if (data) {
               for (let i = 0; i < list.length; i++) {

                  console.log(list[i].courses_enrolled);
                  if (list[i].course_approved == 0 && list[i].course_rejected==0) {
                     tbody = tbody + `<tr>
                                       <td>${list[i].student_id}</td>
                                       <td>
                                         
                                            ${list[i].student_name}
                                          
                                       </td>
                                       <td>${list[i].email}</td>
                                       <td id="sem">${list[i].semester}</td>
                                        <td>${list[i].branch}</td>
                                       <td>${list[i].domain}</td>
                                       <td id="types">${list[i].courses_type}</td>
                                       <td>${list[i].courses_enrolled}</td>
                                       <td>${list[i].total_hours}</td>
                                       <td>${list[i].final_hours}</td>
                                      
                                       <td >
                                          <button type="button" class="button approve" onclick="approve(1,'${list[i].id}','${list[i].email}','${list[i].semester}','${list[i].courses_type}')" style="margin-bottom:10px">
                                             <span class="button__text ">Approve</span>
                                             <span class="button__icon">
                                             <ion-icon name="checkmark-done-outline"></ion-icon></span>
                                          </button>
                                          <button type="button " class="button reject" onclick="approve(0,'${list[i].id}','${list[i].email}','${list[i].semester}','${list[i].courses_type}')">
                                             <span class="button__text">Reject</span>
                                             <span class="button__icon">
                                                <ion-icon name="close-outline"></ion-icon>
                                             </span>
                                          </button>
                                </td>
                                    </tr>
                                    `;

                  } else {
                     if(list.length==0){
                     tbody = "NO Request"
                     }
                  }
               }
               document.getElementById('tbody').innerHTML = tbody;
            }

         } catch (e) {
            console.log("error is:", e);
         }
      }

      getdata();

      async function restSem(){
         try {
            var data=await axios({
               "url":"http://localhost:8000/resetSem",
               "method":"POST",
            })
            if(data.data.result==1){
               alert("Semester Reset")
            }
         }catch(e){
            console.log("error is:", e);
         }
      }

      async function approve(approve, id, email,semester,type) {
         console.log("hello")
         console.log(approve, id, email,semester,type);
         try {
            var response = await axios({
               url: "http://localhost:8000/approveStudentDataOnline",
               method: "post",
               data: { approve: approve, id: id, email: email,semester:semester,type:type }
            });
            console.log(response.data.data);
            var list = response.data.data;
            // tbody = '';  // Clear tbody before appending new rows
            
            // for (let i = 0; i < list.length; i++) {
            //    //console.log(list[i].course_name);
            //    if (list[i].course_approved == 0) {
            //       tbody += `<tr>
            //                 <td>${list[i].student_id}</td>
            //                 <td>${list[i].email}</td>
            //                 <td>${list[i].student_name}</td>
            //                 <td id="sem">${list[i].semester}</td>
            //                 <td>${list[i].branch}</td>
            //                 <td>${list[i].domain}</td>
            //                 <td id="types">${list[i].courses_type}</td>
            //                 <td>${list[i].courses_enrolled}</td>
            //                 <td>${list[i].total_hours}</td>
            //                 <td>${list[i].final_hours}</td>
                            
            //                 <td >
            //                               <button type="button" class="button approve" onclick="approve(1,'${list[i].id}','${list[i].email},'${list[i].semester}','${list[i].courses_type}')" style="margin-bottom:10px">
            //                                  <span class="button__text ">Approve</span>
            //                                  <span class="button__icon">
            //                                  <ion-icon name="checkmark-done-outline"></ion-icon></span>
            //                               </button>
            //                               <button type="button " class="button reject" onclick="approve(0,'${list[i].id}','${list[i].email},'${list[i].semester}','${list[i].courses_type}')">
            //                                  <span class="button__text">Reject</span>
            //                                  <span class="button__icon">
            //                                     <ion-icon name="close-outline"></ion-icon>
            //                                  </span>
            //                               </button>
            //                     </td>
            //              </tr>`;
            //    }
            // }

            // if (list.length == 0) {
            //    tbody = "No Request";
            // }
            // document.getElementById('tbody').innerHTML = tbody;
            getdata("approval")
         } catch (e) {
            console.log("error is:", e);
         }
      }

   </script>
   <script src="assets/js/jquery-3.6.0.min.js"></script>
   <script src="assets/js/popper.min.js"></script>
   <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
   <script src="assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>
   <script src="assets/plugins/apexchart/apexcharts.min.js"></script>
   <script src="assets/plugins/apexchart/chart-data.js"></script>
   <script src="assets/js/script.js"></script>
   <script src="https://unpkg.com/ionicons@5.4.0/dist/ionicons.js"></script>

   <script src="assets/plugins/simple-calendar/jquery.simple-calendar.js"></script>
</body>

</html>